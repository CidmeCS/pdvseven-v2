using a7D.PDV.Fiscal;
using a7D.PDV.Fiscal.Comunicacao.SAT;
using a7D.PDV.Fiscal.SAT._007;
using a7D.PDV.Fiscal.Services;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.IO;
using System.Xml;
using System.Xml.Schema;

namespace a7D.PDV.Testes
{

    [TestClass]
    public class TestSAT
    {
        //string arquivoCFeSAT = "PENGZT48aW5mQ0ZlIElkPSJDRmUzNTE3MDExNDIwMDE2NjAwMDE2NjU5OTAwMDA5ODQ3MDAwMjkyMzE4ODA1OCIgdmVyc2FvPSIwLjA3IiB2ZXJzYW9EYWRvc0VudD0iMC4wNyIgdmVyc2FvU0I9IjAxMDEwMCI+PGlkZT48Y1VGPjM1PC9jVUY+PGNORj4zMTg4MDU8L2NORj48bW9kPjU5PC9tb2Q+PG5zZXJpZVNBVD45MDAwMDk4NDc8L25zZXJpZVNBVD48bkNGZT4wMDAyOTI8L25DRmU+PGRFbWk+MjAxNzAxMjc8L2RFbWk+PGhFbWk+MTc1MDA0PC9oRW1pPjxjRFY+ODwvY0RWPjx0cEFtYj4yPC90cEFtYj48Q05QSj4xNDIwMDE2NjAwMDE2NjwvQ05QSj48c2lnbkFDPlNHUi1TQVQgU0lTVEVNQSBERSBHRVNUQU8gRSBSRVRBR1VBUkRBIERPIFNBVDwvc2lnbkFDPjxhc3NpbmF0dXJhUVJDT0RFPmNSQUpERVNIU3dJVE5xNXprNGFLQm9EcFF4SXEwYWN4UXJxd0xzWU1TQVJnSDR0akluV0RCcnZMck5WY09KZWY4WXhoMEFFQThqdmFCMmlrNk83RHVMZjlnZGpiVURNYnlvaGVPYjZFVmMrZ3h0STkvbVVzaXNjSkRpTGRsS0lvVVhtWlQ2VVdGdXBDL3R5REFZc3R4NDhNMmFuOXllbmt0UUN5ZWRWUWl2MUdyOWdRQU4ybU5hR2R3UlZDNndaUG8rcTdHVmVLUldxVVFjaUZqTmx0TnRYOEVmelMyWTJPT2t5VzJHaUdOZTlpamZxZUQ4R0lBZlFkeDZnRDhEMWhWZldsd2s4ejVtNEVMeE5TbGFydmx6NjF0ZFdXTTVicEFpZ0Q2eTBjL05sQ1BFcWRwNWoyZUxnNEpxckxMQitudkFzN3ZSYmJuYUZ4Z1JVREYra01aZz09PC9hc3NpbmF0dXJhUVJDT0RFPjxudW1lcm9DYWl4YT40MTE8L251bWVyb0NhaXhhPjwvaWRlPjxlbWl0PjxDTlBKPjE0MjAwMTY2MDAwMTY2PC9DTlBKPjx4Tm9tZT5FTEdJTiBJTkRVU1RSSUFMIERBIEFNQVpPTklBIExUREE8L3hOb21lPjxlbmRlckVtaXQ+PHhMZ3I+QVZFTklEQSBBQklVUkFOQTwveExncj48bnJvPjU3OTwvbnJvPjx4QmFpcnJvPkRJU1QgSU5EVVNUUklBTDwveEJhaXJybz48eE11bj5NQU5BVVM8L3hNdW4+PENFUD42OTA3NTAxMDwvQ0VQPjwvZW5kZXJFbWl0PjxJRT4xMTExMTExMTExMTE8L0lFPjxJTT4xMTExMTE8L0lNPjxjUmVnVHJpYj4zPC9jUmVnVHJpYj48aW5kUmF0SVNTUU4+TjwvaW5kUmF0SVNTUU4+PC9lbWl0PjxkZXN0PjwvZGVzdD48ZGV0IG5JdGVtPSIxIj48cHJvZD48Y1Byb2Q+MTg1PC9jUHJvZD48eFByb2Q+MS8yIEJhdGF0YSBmcml0YSB0cmFkaWNpb25hbDwveFByb2Q+PE5DTT4yMTA2OTA5MDwvTkNNPjxDRk9QPjUxMDI8L0NGT1A+PHVDb20+VW48L3VDb20+PHFDb20+MS4wMDAwPC9xQ29tPjx2VW5Db20+MTYuMTQ8L3ZVbkNvbT48dlByb2Q+MTYuMTQ8L3ZQcm9kPjxpbmRSZWdyYT5BPC9pbmRSZWdyYT48dkl0ZW0+MTcuNzU8L3ZJdGVtPjx2UmF0QWNyPjEuNjE8L3ZSYXRBY3I+PC9wcm9kPjxpbXBvc3RvPjx2SXRlbTEyNzQxPjAuNjU8L3ZJdGVtMTI3NDE+PElDTVM+PElDTVNTTjEwMj48T3JpZz4wPC9PcmlnPjxDU09TTj41MDA8L0NTT1NOPjwvSUNNU1NOMTAyPjwvSUNNUz48UElTPjxQSVNTTj48Q1NUPjQ5PC9DU1Q+PC9QSVNTTj48L1BJUz48Q09GSU5TPjxDT0ZJTlNTTj48Q1NUPjQ5PC9DU1Q+PC9DT0ZJTlNTTj48L0NPRklOUz48L2ltcG9zdG8+PC9kZXQ+PHRvdGFsPjxJQ01TVG90Pjx2SUNNUz4wLjAwPC92SUNNUz48dlByb2Q+MTYuMTQ8L3ZQcm9kPjx2RGVzYz4wLjAwPC92RGVzYz48dlBJUz4wLjAwPC92UElTPjx2Q09GSU5TPjAuMDA8L3ZDT0ZJTlM+PHZQSVNTVD4wLjAwPC92UElTU1Q+PHZDT0ZJTlNTVD4wLjAwPC92Q09GSU5TU1Q+PHZPdXRybz4wLjAwPC92T3V0cm8+PC9JQ01TVG90Pjx2Q0ZlPjE3Ljc1PC92Q0ZlPjxEZXNjQWNyRW50cj48dkFjcmVzU3VidG90PjEuNjE8L3ZBY3Jlc1N1YnRvdD48L0Rlc2NBY3JFbnRyPjwvdG90YWw+PHBndG8+PE1QPjxjTVA+MDE8L2NNUD48dk1QPjE3Ljc1PC92TVA+PC9NUD48dlRyb2NvPjAuMDA8L3ZUcm9jbz48L3BndG8+PC9pbmZDRmU+PFNpZ25hdHVyZSB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+PFNpZ25lZEluZm8+PENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSI+PC9DYW5vbmljYWxpemF0aW9uTWV0aG9kPjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ij48L1NpZ25hdHVyZU1ldGhvZD48UmVmZXJlbmNlIFVSST0iI0NGZTM1MTcwMTE0MjAwMTY2MDAwMTY2NTk5MDAwMDk4NDcwMDAyOTIzMTg4MDU4Ij48VHJhbnNmb3Jtcz48VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiPjwvVHJhbnNmb3JtPjxUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSI+PC9UcmFuc2Zvcm0+PC9UcmFuc2Zvcm1zPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiPjwvRGlnZXN0TWV0aG9kPjxEaWdlc3RWYWx1ZT5HTzRicEJKQ2dYOGxHek5leGJjZUJnTmVuNTQ0dk9tNzFRWUcwNlNSckprPTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT5OS2tKK2NVN043YUxwNVF2bDVBRnRaaWlMY3JYNmtlYUVtWTBXUVlEQUgrdVJFVHlBRjl0eldRam5nMEFLckpuZ29FQXR4WHZYREkzMU5UY2lvK3pxV1lIOUpIamh3RWpzbXBXdWZnMTFqamkwRythNENkZENpQWNXQXord0wzUDM0cVR6alNva3kyNExUNm1yQUNXQmR3OUIyTUtiaGRjSXQ4ZFh1WkVNOUNCOHVBZmVQaXJIcUxjTUtSc1ZtMnVHaWpFSTZGbkEvcE5BZkErRmxQR1FONHRhRnBKSFJ2TW9TNnhMTW1jaTc1cC9Pd25NVkc5R3IzbEswc2cyczU5d0RWUG1WcTFCcWgzTE1pS043RUhtNHR2QTJrYTVnUXE4cU42OGtoaTBhSDVCYzZDbGF1NWRiYmtGTzJJbWVzL0ZoV01JWnJJc3hRdS9PN04yeDFiU3c9PTwvU2lnbmF0dXJlVmFsdWU+PEtleUluZm8+PFg1MDlEYXRhPjxYNTA5Q2VydGlmaWNhdGU+TUlJRnpqQ0NCTGFnQXdJQkFnSUNENUF3RFFZSktvWklodmNOQVFFTkJRQXdhREVMTUFrR0ExVUVCaE1DUWxJeEVqQVFCZ05WQkFnTUNWTkJUeUJRUVZWTVR6RVNNQkFHQTFVRUJ3d0pVMEZQSUZCQlZVeFBNUTh3RFFZRFZRUUtEQVpCUTBaVlUxQXhEekFOQmdOVkJBc01Ca0ZEUmxWVFVERVBNQTBHQTFVRUF3d0dRVU5HVlZOUU1CNFhEVEUyTVRFeE9ERTNNakV3T0ZvWERUSXhNVEV4TnpFM01qRXdPRm93Z2JNeEN6QUpCZ05WQkFZVEFrSlNNUkl3RUFZRFZRUUlEQWxUWVc4Z1VHRjFiRzh4RVRBUEJnTlZCQW9NQ0ZORlJrRmFMVk5RTVJnd0ZnWURWUVFMREE5QlF5QlRRVlFnVTBWR1FWb2dVMUF4S0RBbUJnTlZCQXNNSDBGMWRHOXlhV1JoWkdVZ1pHVWdVbVZuYVhOMGNtOGdVMFZHUVZvZ1UxQXhPVEEzQmdOVkJBTU1NRVZNUjBsT0lFbE9SRlZUVkZKSlFVd2dSRUVnUVUxQldrOU9TVUVnVEZSRVFUb3hOREl3TURFMk5qQXdNREUyTmpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBSXdRbkVmZVpBYVgrR3NSVEIzVVNXaWZ0eTRodHN5MUpUV0VSalVqOUYrZ0RVYVM4MW9RUUk0R1FZVm9rU0xRcFlXVTFGekpsbVJQSTBZenFpbk9MckNPOFJReVR3S0JJYlQ1dkdsVFZkaTV2VWVrbVFEeTAwMDFTVklSdWV2eE1RYWRHUk9JMy8wdmxWWElPTU0wZDd2MmdKZjJkL3VHQTZGdS8wbi9CY2hraWlCaXp3Ti9NN24vaWhPZC9zUXZ5VmFJNnM5UloxRjhBNStjVlFvVzA4NXp4LzhyRUlzdTFIYUUzWmhiM3hGRnZQN2pMZEw1b0lka2N1UHg5ZzkxQndDMTQ4RzBWS05Pek5nVjJ4dmVoaGY5MGFvTlZwK08rVUhyQ1dJMGhNc05VRGJwRzdqWWNvNWh4c2ZwMnZDenJ4RFd1dWxVVW8vZm9rdHNwY1NrZFVzQ0F3RUFBYU9DQWpRd2dnSXdNQWtHQTFVZEV3UUNNQUF3RGdZRFZSMFBBUUgvQkFRREFnWGdNQ3dHQ1dDR1NBR0crRUlCRFFRZkZoMVBjR1Z1VTFOTUlFZGxibVZ5WVhSbFpDQkRaWEowYVdacFkyRjBaVEFkQmdOVkhRNEVGZ1FVajNNNE5DbWs5UjVucFpGK21VTFgvTmJ4Yldjd0h3WURWUjBqQkJnd0ZvQVVGYlRqa1lZa0xPb3pUd1VlTFMrVHQwaVh4M2d3RXdZRFZSMGxCQXd3Q2dZSUt3WUJCUVVIQXdJd1F3WURWUjBmQkR3d09qQTRvRGFnTklZeWFIUjBjRG92TDJGamMyRjBMbVpoZW1WdVpHRXVjM0F1WjI5MkxtSnlMMkZqYzJGMGMyVm1ZWHB6Y0dOeWJDNWpjbXd3Z2FjR0NDc0dBUVVGQndFQkJJR2FNSUdYTURVR0NDc0dBUVVGQnpBQmhpbG9kSFJ3T2k4dmIyTnpjQzF3YVd4dmRDNXBiWEJ5Wlc1ellXOW1hV05wWVd3dVkyOXRMbUp5THpCZUJnZ3JCZ0VGQlFjd0FvWlNhSFIwY0RvdkwyRmpjMkYwTFhSbGMzUmxMbWx0Y0hKbGJuTmhiMlpwWTJsaGJDNWpiMjB1WW5JdmNtVndiM05wZEc5eWFXOHZZMlZ5ZEdsbWFXTmhaRzl6TDJGamMyRjBMWFJsYzNSbExuQTNZekI3QmdOVkhTQUVkREJ5TUhBR0NTc0dBUVFCZ2V3dEF6QmpNR0VHQ0NzR0FRVUZCd0lCRmxWb2RIUndPaTh2WVdOellYUXVhVzF3Y21WdWMyRnZabWxqYVdGc0xtTnZiUzVpY2k5eVpYQnZjMmwwYjNKcGJ5OWtjR012WVdOellYUnpaV1poZW5Od0wyUndZMTloWTNOaGRITmxabUY2YzNBdWNHUm1NQ1FHQTFVZEVRUWRNQnVnR1FZRllFd0JBd09nRUF3T01UUXlNREF4TmpZd01EQXhOall3RFFZSktvWklodmNOQVFFTkJRQURnZ0VCQUZmcFBCTHdRSUNhMkt1Sy9MTGdmWVlpZVRySXp0U3hnai84WGx5OTZnMWFNQVdtR3pxNmZTaVJNekMrV0dyV2FvRVYvaFM5Y1N6S2dEVE42TVBheVZkWm5nWlFzenZObGhSODlFYjVZM09DOUtKMitqZ1NZNzFBS0ppdXhRbERNenNnYzBxRUVML3JkZHRrOHV5cDNqZE5OdnFCWmJBN0Fibzh3RzRKRUNHUVNra21YdUhya2p2eXpZeEszYjZubnFjR29rUEwzRkNjRENKWmJ1WTg0OFRZcFF1WWxvcjBTSElLL2lTbitVdVJ0SGtxNWpibVBCSG1CKytaYnMwaENRSDB3UEc3Nm0wTXZ0aTBpTVZkQU15YWxaSmdKU08rN2JOSmVjNGtscUUzZnRvNnFMdFVLOCtBS3NKaGkzS1BIdEI4YVF6NGh3SFVpTlQ5Sk9xRHZQdz08L1g1MDlDZXJ0aWZpY2F0ZT48L1g1MDlEYXRhPjwvS2V5SW5mbz48L1NpZ25hdHVyZT48L0NGZT4=";
        //string arquivoCFeSAT = @"PENGZT48aW5mQ0ZlIElkPSJDRmUzNTE2MDYwNzM1ODkxNjAwMDE2NzU5MDAwMTQ4Mzk1MDAzNTQ2MDA3MjAzMiIgdmVyc2FvPSIwLjA2IiB2ZXJzYW9EYWRvc0VudD0iMC4wNiIgdmVyc2FvU0I9IjAxMDAwMCI+PGlkZT48Y1VGPjM1PC9jVUY+PGNORj4wMDcyMDM8L2NORj48bW9kPjU5PC9tb2Q+PG5zZXJpZVNBVD4wMDAxNDgzOTU8L25zZXJpZVNBVD48bkNGZT4wMDM1NDY8L25DRmU+PGRFbWk+MjAxNjA2MTA8L2RFbWk+PGhFbWk+MTgzMzEyPC9oRW1pPjxjRFY+MjwvY0RWPjx0cEFtYj4xPC90cEFtYj48Q05QSj4yMzQ4NzQwMzAwMDEwMjwvQ05QSj48c2lnbkFDPk9BQ05ua2pXekxkczNlL0I5QUh5MndHbXZ6TThCU1I1VithQ0JyNmxIUnFBemUzdGpZWHJ6djJFWHVjNXFOWDVjMloxenhRdlUxT0Z3RDUybjVPZ2I5ZTNIU0NiZ21mRFpidmUvUnhqMFlsRnRUQ2h3UXV1bHRaQTRMZTJWdjNLS1ZUSmpsNExQR2pFUFJlQU1JVDZpYWJ4U3J1Q2ZVcWRtdDNlWVVUWFEwMGxiamJWeTR0Yjgxcmk0Z2xmVmU1T2svdjhETDlvNEJpTUdUVEM1Qks0MmdFU0h3cEhXelFzSEdrdFJvLzZKKzk5N21RMm1RV1BlS1l2dUxla1pMN0ZPSkd6ZlArMDJsSlFCanoxb3E1OHlZU3Jjbnh6L2Y0QW5sN245MXg0RTE5R25WMkRDaGkzczBHbkJhWWV4YUV6eUI3cVd1VmtuREZGa2poTlFHdklmUT09PC9zaWduQUM+PGFzc2luYXR1cmFRUkNPREU+Ymcza2cxdUdJYTIxeW91RkFBMzhpeVBNUWJoUXlPd2loZHVIUnNWczNXSnNFblhLN09qM1JkeXV6bVlua1BlenF4M3lUTkhPdEdXaEgwL04vU0oxeFBGRFJkZTlFcnAyNDN2RUlDWmszQVd4eVVoU3ZvMzU4T1hWWno0SnppRy9RaEcxMWxvdHN1MjZkV0hQQ29QV1BVY2djWGlVaUFMR2NMRmxMUG1Nbk03KzI4cTBjdC9oVEJCR2NVQXlaK0RkMW9qck5pZUVsWjBkUlZtYVVPRjZXSDdBQWFCUkNWcGp6SmtQRHdaUFNGUldydFlxYkxtMS93NVNFbC8ybmNoa242OFczQlZiQnRMcERZY2dBakk4N0dOYzRFZ1p1ejgrOWlQTzRzT0pQYVFjd2pCSFJrcThiQ3g4MWp5bW5sdmFjekFxZCt5OU1KdjFVZmZUR21rd2xnPT08L2Fzc2luYXR1cmFRUkNPREU+PG51bWVyb0NhaXhhPjIwNzwvbnVtZXJvQ2FpeGE+PC9pZGU+PGVtaXQ+PENOUEo+MDczNTg5MTYwMDAxNjc8L0NOUEo+PHhOb21lPkdBTEVURVJJQSBDQVBPTEVUSSBMVERBIE1FPC94Tm9tZT48ZW5kZXJFbWl0Pjx4TGdyPkFWRU5JREEgSU1QRVJBVFJJWiBMRU9QT0xESU5BPC94TGdyPjxucm8+NDQxPC9ucm8+PHhDcGw+QU5FWE8gNDMzPC94Q3BsPjx4QmFpcnJvPk5PVkEgUEVUUk9QT0xJUzwveEJhaXJybz48eE11bj5TQU8gQkVSTkFSRE8gRE8gQ0FNUE88L3hNdW4+PENFUD4wOTc3MDI3MjwvQ0VQPjwvZW5kZXJFbWl0PjxJRT42MzU1MTQ0ODgxMTM8L0lFPjxjUmVnVHJpYj4xPC9jUmVnVHJpYj48aW5kUmF0SVNTUU4+TjwvaW5kUmF0SVNTUU4+PC9lbWl0PjxkZXN0PjwvZGVzdD48ZGV0IG5JdGVtPSIxIj48cHJvZD48Y1Byb2Q+MTE2PC9jUHJvZD48eFByb2Q+QWd1YSBDLyBHw6FzPC94UHJvZD48TkNNPjIyMDIxMDAwPC9OQ00+PENGT1A+NTQwNTwvQ0ZPUD48dUNvbT5VbjwvdUNvbT48cUNvbT4xLjAwMDA8L3FDb20+PHZVbkNvbT40LjUwPC92VW5Db20+PHZQcm9kPjQuNTA8L3ZQcm9kPjxpbmRSZWdyYT5BPC9pbmRSZWdyYT48dkl0ZW0+NC45NTwvdkl0ZW0+PHZSYXRBY3I+MC40NTwvdlJhdEFjcj48L3Byb2Q+PGltcG9zdG8+PElDTVM+PElDTVNTTjEwMj48T3JpZz4wPC9PcmlnPjxDU09TTj4xMDI8L0NTT1NOPjwvSUNNU1NOMTAyPjwvSUNNUz48UElTPjxQSVNTTj48Q1NUPjQ5PC9DU1Q+PC9QSVNTTj48L1BJUz48Q09GSU5TPjxDT0ZJTlNTTj48Q1NUPjQ5PC9DU1Q+PC9DT0ZJTlNTTj48L0NPRklOUz48L2ltcG9zdG8+PC9kZXQ+PHRvdGFsPjxJQ01TVG90Pjx2SUNNUz4wLjAwPC92SUNNUz48dlByb2Q+NC41MDwvdlByb2Q+PHZEZXNjPjAuMDA8L3ZEZXNjPjx2UElTPjAuMDA8L3ZQSVM+PHZDT0ZJTlM+MC4wMDwvdkNPRklOUz48dlBJU1NUPjAuMDA8L3ZQSVNTVD48dkNPRklOU1NUPjAuMDA8L3ZDT0ZJTlNTVD48dk91dHJvPjAuMDA8L3ZPdXRybz48L0lDTVNUb3Q+PHZDRmU+NC45NTwvdkNGZT48RGVzY0FjckVudHI+PHZBY3Jlc1N1YnRvdD4wLjQ1PC92QWNyZXNTdWJ0b3Q+PC9EZXNjQWNyRW50cj48L3RvdGFsPjxwZ3RvPjxNUD48Y01QPjAxPC9jTVA+PHZNUD40Ljk1PC92TVA+PC9NUD48dlRyb2NvPjAuMDA8L3ZUcm9jbz48L3BndG8+PC9pbmZDRmU+PFNpZ25hdHVyZSB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+PFNpZ25lZEluZm8geG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUiPjwvQ2Fub25pY2FsaXphdGlvbk1ldGhvZD48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjcnNhLXNoYTI1NiI+PC9TaWduYXR1cmVNZXRob2Q+PFJlZmVyZW5jZSBVUkk9IiNDRmUzNTE2MDYwNzM1ODkxNjAwMDE2NzU5MDAwMTQ4Mzk1MDAzNTQ2MDA3MjAzMiI+PFRyYW5zZm9ybXM+PFRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlIj48L1RyYW5zZm9ybT48VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUiPjwvVHJhbnNmb3JtPjwvVHJhbnNmb3Jtcz48RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ij48L0RpZ2VzdE1ldGhvZD48RGlnZXN0VmFsdWU+OTBkdDRhSXVoS0NrWGFYNVZFUm1XSENQZkMvMjlFeTUzUWZNaEVDV3U1OD08L0RpZ2VzdFZhbHVlPjwvUmVmZXJlbmNlPjwvU2lnbmVkSW5mbz48U2lnbmF0dXJlVmFsdWU+RnJZTEhmYXZRUWpsNGxGTXV1Nzg5bEhtcWQ5U2pNdnUvM3duUWpXQ2tYTjU4SExpQngwN2wvT01VMlhnU2ROTUZialhscHY1Z1lWdGppZFUzRUhtZEFjd0VoVDJPL2gycDBsRUE0ZWlwMzBlbGdyVm9qYTVtbGtoWUs0M1ZKM1NueDdDTWZZNVZ1ajJkRGM3ZFMrekhGTG1uK2Z0QWtiRTgzNER5eG9Ob1Y5dGUrQlhZTThBTDJyTnJERjdwMTlhcFZXdE1QSmw1bEcvNjBFZDdXb2ZoQkdienlQbWNaVE1pRytCWnF3Uy9ZVnMyR1NEcy9BVzFySnlCKzdwanEzcXpaMDg5RkwzRWJwRFZ0bXJmdHhnL2tyOVY4VWNyUTV5eFg4M0N2d0h1c0RsZFZCbkF2R0haQ3NCV1R1ZnZDakZzUlJITjhTMnNWL0cwZitGZllQUE1BPT08L1NpZ25hdHVyZVZhbHVlPjxLZXlJbmZvPjxYNTA5RGF0YT48WDUwOUNlcnRpZmljYXRlPk1JSUdmakNDQkdhZ0F3SUJBZ0lKQVNLZEx5QWRSeDdaTUEwR0NTcUdTSWIzRFFFQkN3VUFNRkV4TlRBekJnTlZCQW9UTEZObFkzSmxkR0Z5YVdFZ1pHRWdSbUY2Wlc1a1lTQmtieUJGYzNSaFpHOGdaR1VnVTJGdklGQmhkV3h2TVJnd0ZnWURWUVFERXc5QlF5QlRRVlFnVTBWR1FWb2dVMUF3SGhjTk1UWXdNekk1TVRjeU16SXdXaGNOTWpFd016STVNVGN5TXpJd1dqQ0J0ekVTTUJBR0ExVUVCUk1KTURBd01UUTRNemsxTVFzd0NRWURWUVFHRXdKQ1VqRVNNQkFHQTFVRUNCTUpVMkZ2SUZCaGRXeHZNUkV3RHdZRFZRUUtFd2hUUlVaQldpMVRVREVQTUEwR0ExVUVDeE1HUVVNdFUwRlVNU2d3SmdZRFZRUUxFeDlCZFhSbGJuUnBZMkZrYnlCd2IzSWdRVklnVTBWR1FWb2dVMUFnVTBGVU1USXdNQVlEVlFRREV5bEhRVXhGVkVWU1NVRWdRMEZRVDB4RlZFa2dURlJFUVNCTlJUb3dOek0xT0RreE5qQXdNREUyTnpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBSUR6TGZnM2EyaU9EVkNIL0tMUmJUbHE2bUJhMll4NHVVd3JsYXdhb0NpeVRmT0hNYm5CaGx4cisxSCtpaktSYWVUUWRwWm5ZdXJUZEhMYTlXVUcvaWhsWHNlcS9HNmg4THZmcWpJcFB2L1hSR0tMSHhTTEVjN283VGlndG4vSDZjOWhVV1dCWUxsNkxuTWoxYlk5V3Z0cXBqYTFIUW9HQWpGcmdMbGZ0SWhUTEpGbW1KblBFRmh0NXlkd2JvbmUzYUxiRC94bTNNN1JkTHQzSVNKS3lYUlFrV0pTdXU0ZkZHNUpzcHFqUjNZQVNhYmh6M1JPeGVnZW9MZWM0TnFTYmFHeFVVOGhKSkt2U1M3MnlZVG9XcDJGM210b1E4R1p2ZEtKMXMvNTgybXZJakRseHprcHZodmppMnNVU0UzcDlHaWp4TXpYTnBIQTczSHo2Mjh5dEdVQ0F3RUFBYU9DQWZBd2dnSHNNQTRHQTFVZER3RUIvd1FFQXdJRjREQjFCZ05WSFNBRWJqQnNNR29HQ1NzR0FRUUJnZXd0QXpCZE1Gc0dDQ3NHQVFVRkJ3SUJGazlvZEhSd09pOHZZV056WVhRdWFXMXdjbVZ1YzJGdlptbGphV0ZzTG1OdmJTNWljaTl5WlhCdmMybDBiM0pwYnk5a2NHTXZZV056WldaaGVuTndMMlJ3WTE5aFkzTmxabUY2YzNBdWNHUm1NR1VHQTFVZEh3UmVNRnd3V3FCWW9GYUdWR2gwZEhBNkx5OWhZM05oZEM1cGJYQnlaVzV6WVc5bWFXTnBZV3d1WTI5dExtSnlMM0psY0c5emFYUnZjbWx2TDJ4amNpOWhZM05oZEhObFptRjZjM0F2WVdOellYUnpaV1poZW5Od1kzSnNMbU55YkRDQmxBWUlLd1lCQlFVSEFRRUVnWWN3Z1lRd0xnWUlLd1lCQlFVSE1BR0dJbWgwZEhBNkx5OXZZM053TG1sdGNISmxibk5oYjJacFkybGhiQzVqYjIwdVluSXdVZ1lJS3dZQkJRVUhNQUtHUm1oMGRIQTZMeTloWTNOaGRDNXBiWEJ5Wlc1ellXOW1hV05wWVd3dVkyOXRMbUp5TDNKbGNHOXphWFJ2Y21sdkwyTmxjblJwWm1sallXUnZjeTloWTNOaGRDNXdOMk13RXdZRFZSMGxCQXd3Q2dZSUt3WUJCUVVIQXdJd0NRWURWUjBUQkFJd0FEQWtCZ05WSFJFRUhUQWJvQmtHQldCTUFRTURvQkFFRGpBM016VTRPVEUyTURBd01UWTNNQjhHQTFVZEl3UVlNQmFBRkxDRmdiTW96WFlxS1NSTFgxaEtiMmpackxBcU1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQ0FRQXZwSjhGSHFoOEFFWXRHUzhQSWdJUjZrMlF3TTVIUDlCV2dUU2V5UjIrOHY5RDRNZDBkamZuckhqSlVHbFVDOUhhTTFOa2ZDbjMvQlhEWXJEamJzZVNLdFBqRWV3SzhFcjFyMFRaek1NSk9PSnpwL2srNVh2ZDlROGdiamo1TzhhV3dMaDUrL3NlczB4bDRKeUF4ekdkNHRSUGN1c2hQdUxpZXNXMzRrY2szTlRFajdoTGdYL3JEdzhMNWh4Nk10Ulg4Y2QzNUdBQzRTb2N1OUtQOFVubWkyR1FuaDVMeDFvK0pmcGJoSElNRTErVWsycWU3Kzd2VGl0RnZiUmdQYXhUMHdOcGQ3RnV3RWtRZWpRcGtXL1E5OFRQcEdvbjRQWGZQalZOUWdMc1JmdEVzdTJabU1lQmx6M2hqN3JLSjd4OGMySkJ3cjNoOGZPSjdYU1k4MjdRREFqS0t5WWR4dkcyTWZ3b2M2RGVENGphTUJmS0N5UytONzVFcE1Ec0dTbk4zQU9sbkthL3lYYnR3RU4ycHcxcUU2OFhiZmdaL2pjTlEzM1NTRnphc3BrSks2TEtrYnJUYUxUTUNra2FNRVVjc3drcXFMYTRaQWo4Wm91UTJIa0F2ZGIrRk43c090MVhaOHpJVVVzS0pzd0Y0Y3NyNFdRSnZVUkVDTFcvSER3Z2hEUUdnZGF1L0lyd01PeEM4eUttSjdTWUpFN3kwUjc1R0FMRHlCblJUZ0d2Vi8wSkNVd0JZK0JWR2RWS1NSWjRxc3NnQzZGaDhhdEcrSy9uWWdUZ0VYSHNJVGhVTGJRODN2QlZFbFhxWkxTWk82NUZGTnVuVEo2Q2R5Zk5TMnk1N2J6SmtpaFowQU1QT2wzMExFSEdEU2JEYXRTMzUrYURMa0F0RDBqSS9nPT08L1g1MDlDZXJ0aWZpY2F0ZT48L1g1MDlEYXRhPjwvS2V5SW5mbz48L1NpZ25hdHVyZT48L0NGZT4=";
        //string arquivoCFeSAT = @"PENGZT48aW5mQ0ZlIElkPSJDRmUzNTE2MTIyMjk1ODcwMTAwMDE3MDU5MDAwMTE5OTM1MDAxMDUwODI4NjgyMiIgdmVyc2FvPSIwLjA3IiB2ZXJzYW9EYWRvc0VudD0iMC4wNyIgdmVyc2FvU0I9IjAxMDEwMCI+PGlkZT48Y1VGPjM1PC9jVUY+PGNORj44Mjg2ODI8L2NORj48bW9kPjU5PC9tb2Q+PG5zZXJpZVNBVD4wMDAxMTk5MzU8L25zZXJpZVNBVD48bkNGZT4wMDEwNTA8L25DRmU+PGRFbWk+MjAxNjEyMjc8L2RFbWk+PGhFbWk+MTYwMDU0PC9oRW1pPjxjRFY+MjwvY0RWPjx0cEFtYj4xPC90cEFtYj48Q05QSj4yMzQ4NzQwMzAwMDEwMjwvQ05QSj48c2lnbkFDPnBlVXlibTMyNWtoM1ZkMFpDZWdYWXlObnZ1bDdQbU11enA0U09zcTFlbHR5ODN0eTBwZ1NZa0t0VzJWbDFrb1JMWm1KRVdyeUVraDNGb21zL1Q0YlBqRFdPTmtFdjhDWjk0emhrQlF1WUhiTDRaS2Eyb1ovN3J1QmNoWDRtWURISlpZciswc3Mva0xUcHhDcUg2ZDVncm9xWW9sOFpOdmpaMVZpSzZmNlpaWDJlWHhqT3RrL1hMRTRoRHRaeDJndkY2TjBzK2JwZnRDOVJuYXFKTS8ybkdWUThBMkNrdDMxNWlSUDM4d2IzTU4rd1Q2aFpMQnNWUWVIVm1NMndHSzNKdXUxbWtCTVEvYTlCVXQ0UWlxUDR3LytKZlBJZHdXM0svTzdTR0U4UnBNZ3Npa284ZVlrdUc2bnUrQUZoemhkV0VlbG1FUUtOMFBWQnJ5VFFDZkh0dz09PC9zaWduQUM+PGFzc2luYXR1cmFRUkNPREU+ZE84RUJLZGI4Ung4YWM5dWN4N2RwUUVnaVBHZ29zOStUeWNZY2libm5sQkw0d1hxSVVKbmFteHYyb0svcDZlMElySTE1dkY4MkhLZ0xkdzZVWTdQWGFyOVBFVENKUE1DQ0dzSVBBK0t6a0VyN0w1WkR4aU9Wc0dZT01RV2s2c1lJU21TdXdoWS9mSHBFdVc1U3BGWFBoR0pVT1diWGRMZGFMNk04K3ZPUEk0TVZRaFJNVTZKNlhQNk9aSUZTWkFrU2RUNjhibEtsVlFGWkxia0syUzdaeEZCRWJTd1lkMjFUM2xscFo5NHpLRFJEUjJiN1pPN0NVaWJZVnRiZHhmRk11TlkwTkhLemEydU9pa0VJQzQwNTkrRk1NUHg2Z0FOV1FSYnR0QXJkKzBuMkdyZ0RPZWExVHhDK3QwaERYTDhlMjJpSS9aL0dJM3lEbkNyRkpPSjBBPT08L2Fzc2luYXR1cmFRUkNPREU+PG51bWVyb0NhaXhhPjQxMTwvbnVtZXJvQ2FpeGE+PC9pZGU+PGVtaXQ+PENOUEo+MjI5NTg3MDEwMDAxNzA8L0NOUEo+PHhOb21lPlNJUkkgR0FTVFJPIEJBUiBMVERBIE1FPC94Tm9tZT48eEZhbnQ+U0lSSSBCVVJHRVI8L3hGYW50PjxlbmRlckVtaXQ+PHhMZ3I+QVZFTklEQSBBTlRBUlRJQ0E8L3hMZ3I+PG5ybz40NTc8L25ybz48eEJhaXJybz5BR1VBIEJSQU5DQTwveEJhaXJybz48eE11bj5TQU8gUEFVTE88L3hNdW4+PENFUD4wNTAwMzAyMDwvQ0VQPjwvZW5kZXJFbWl0PjxJRT4xNDQ4NTE4NzkxMTg8L0lFPjxJTT41Mjk2NTM2ODwvSU0+PGNSZWdUcmliPjE8L2NSZWdUcmliPjxpbmRSYXRJU1NRTj5OPC9pbmRSYXRJU1NRTj48L2VtaXQ+PGRlc3Q+PC9kZXN0PjxkZXQgbkl0ZW09IjEiPjxwcm9kPjxjUHJvZD4yMzwvY1Byb2Q+PHhQcm9kPkJpZmUgQW5jaG8gR3JlbGhhZG88L3hQcm9kPjxOQ00+MjEwNjkwOTA8L05DTT48Q0ZPUD41MTAyPC9DRk9QPjx1Q29tPlVuPC91Q29tPjxxQ29tPjEuMDAwMDwvcUNvbT48dlVuQ29tPjk5LjkwPC92VW5Db20+PHZQcm9kPjk5LjkwPC92UHJvZD48aW5kUmVncmE+QTwvaW5kUmVncmE+PHZJdGVtPjAuMDE8L3ZJdGVtPjx2UmF0RGVzYz45OS44OTwvdlJhdERlc2M+PC9wcm9kPjxpbXBvc3RvPjx2SXRlbTEyNzQxPjQuMDA8L3ZJdGVtMTI3NDE+PElDTVM+PElDTVNTTjEwMj48T3JpZz4wPC9PcmlnPjxDU09TTj41MDA8L0NTT1NOPjwvSUNNU1NOMTAyPjwvSUNNUz48UElTPjxQSVNTTj48Q1NUPjQ5PC9DU1Q+PC9QSVNTTj48L1BJUz48Q09GSU5TPjxDT0ZJTlNTTj48Q1NUPjQ5PC9DU1Q+PC9DT0ZJTlNTTj48L0NPRklOUz48L2ltcG9zdG8+PC9kZXQ+PHRvdGFsPjxJQ01TVG90Pjx2SUNNUz4wLjAwPC92SUNNUz48dlByb2Q+OTkuOTA8L3ZQcm9kPjx2RGVzYz4wLjAwPC92RGVzYz48dlBJUz4wLjAwPC92UElTPjx2Q09GSU5TPjAuMDA8L3ZDT0ZJTlM+PHZQSVNTVD4wLjAwPC92UElTU1Q+PHZDT0ZJTlNTVD4wLjAwPC92Q09GSU5TU1Q+PHZPdXRybz4wLjAwPC92T3V0cm8+PC9JQ01TVG90Pjx2Q0ZlPjAuMDE8L3ZDRmU+PERlc2NBY3JFbnRyPjx2RGVzY1N1YnRvdD45OS44OTwvdkRlc2NTdWJ0b3Q+PC9EZXNjQWNyRW50cj48L3RvdGFsPjxwZ3RvPjxNUD48Y01QPjAxPC9jTVA+PHZNUD4wLjAxPC92TVA+PC9NUD48dlRyb2NvPjAuMDA8L3ZUcm9jbz48L3BndG8+PC9pbmZDRmU+PFNpZ25hdHVyZSB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+PFNpZ25lZEluZm8+PENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSI+PC9DYW5vbmljYWxpemF0aW9uTWV0aG9kPjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ij48L1NpZ25hdHVyZU1ldGhvZD48UmVmZXJlbmNlIFVSST0iI0NGZTM1MTYxMjIyOTU4NzAxMDAwMTcwNTkwMDAxMTk5MzUwMDEwNTA4Mjg2ODIyIj48VHJhbnNmb3Jtcz48VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiPjwvVHJhbnNmb3JtPjxUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSI+PC9UcmFuc2Zvcm0+PC9UcmFuc2Zvcm1zPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiPjwvRGlnZXN0TWV0aG9kPjxEaWdlc3RWYWx1ZT5ORlBya2lXZy9pYkc2WmpvYnhienlzdGdwNWFXYVN0cXpydmFxUXIxVThRPTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT5UKzZoWWhkUVFmVXYvRExIQmZGVHZWWm9ETzRmTnZZd0Y5M21FUDhON3YxRXpuRWVDUjNXMWdjWTJFUC9DdzdvNVliTFExa1FZbXBYRzFkNnJBN1BXVGF1T0E5SmpXT3dwZmp5T0ZvM1ZMc0FlRjN4b2M4dldBS0tGNmlIeTlrR0tUdlM1QVc0bnlGRVFRS2kzQ0p5UUJ4a0o0aUVnaVhFQm5zb05XQTVCeDl4VjVrelRFRVNRT0JFTlU1YldlUDREdXdaSW9YYW85b1I1N0daYzI2TGtQUXIxcEZPOWgwRVlwY0pxNzFlZHc1eFVSbVRHOHhDV0tPdFJhVnZlbUFFbnh3VkRzWGJOcURRYnNQZmhDcUNGSFpRSU9YbGdEMEZEUmdlMHBHRUJxcFNVZEtzNUh2NVgxSU9SdTFVc3JiZ0ZvWithdkY2aHVhRVN3YW1VdjR3MlE9PTwvU2lnbmF0dXJlVmFsdWU+PEtleUluZm8+PFg1MDlEYXRhPjxYNTA5Q2VydGlmaWNhdGU+TUlJR2V6Q0NCR09nQXdJQkFnSUpBUnowZk9SMU52Y0JNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1GRXhOVEF6QmdOVkJBb1RMRk5sWTNKbGRHRnlhV0VnWkdFZ1JtRjZaVzVrWVNCa2J5QkZjM1JoWkc4Z1pHVWdVMkZ2SUZCaGRXeHZNUmd3RmdZRFZRUURFdzlCUXlCVFFWUWdVMFZHUVZvZ1UxQXdIaGNOTVRZd09URTFNVGd5TmpRM1doY05NakV3T1RFMU1UZ3lOalEzV2pDQnRERVNNQkFHQTFVRUJSTUpNREF3TVRFNU9UTTFNUXN3Q1FZRFZRUUdFd0pDVWpFU01CQUdBMVVFQ0JNSlUyRnZJRkJoZFd4dk1SRXdEd1lEVlFRS0V3aFRSVVpCV2kxVFVERVBNQTBHQTFVRUN4TUdRVU10VTBGVU1TZ3dKZ1lEVlFRTEV4OUJkWFJsYm5ScFkyRmtieUJ3YjNJZ1FWSWdVMFZHUVZvZ1UxQWdVMEZVTVM4d0xRWURWUVFERXlaVFNWSkpJRWRCVTFSU1R5QkNRVklnVEZSRVFTQk5SVG95TWprMU9EY3dNVEF3TURFM01EQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUlHdnQ2NVpLMHZrdmlQU0h2cHpvWHdJb3gzS3VOK3NhSVJLSE9SdndYZ3NQQkU3ZkYraldMdkJNTFhTT3U5anJrYmcrdkpLWkMxS1hBVllBa2lncVkrUTdTN3poRzZKbjZyR3ZUUlNscUtwOG95bjZaSHdOTFZXaTVvS3BSUXFWM0g5cWp3S1BtQm5URy8xQXNoWXcvbERYYVpQYUo5Y3h2THoxcWFaMDNLb2Z6UVUrRnNZYVpabGFZTGRWMExTaVd5TTlwd3lmelN3d1YyMUIrNkZaaUo2SmthbVo5S2JLVE16dU9PMSs4WXBFZkZtZzUxQkgyWUF5T1ZJVGs5Y0liOHJic2NHZi9jcUc0VWgvMmk2S2Y0RkRPUDdlYmdncXhYYTRCQ3JPdE5UbGpTU0JOVk9wWnZOSDd5eFhUREpWcWlyRitEMUI1THMxeDR3Tk5XbE1IVUNBd0VBQWFPQ0FmQXdnZ0hzTUE0R0ExVWREd0VCL3dRRUF3SUY0REIxQmdOVkhTQUViakJzTUdvR0NTc0dBUVFCZ2V3dEF6QmRNRnNHQ0NzR0FRVUZCd0lCRms5b2RIUndPaTh2WVdOellYUXVhVzF3Y21WdWMyRnZabWxqYVdGc0xtTnZiUzVpY2k5eVpYQnZjMmwwYjNKcGJ5OWtjR012WVdOelpXWmhlbk53TDJSd1kxOWhZM05sWm1GNmMzQXVjR1JtTUdVR0ExVWRId1JlTUZ3d1dxQllvRmFHVkdoMGRIQTZMeTloWTNOaGRDNXBiWEJ5Wlc1ellXOW1hV05wWVd3dVkyOXRMbUp5TDNKbGNHOXphWFJ2Y21sdkwyeGpjaTloWTNOaGRITmxabUY2YzNBdllXTnpZWFJ6WldaaGVuTndZM0pzTG1OeWJEQ0JsQVlJS3dZQkJRVUhBUUVFZ1ljd2dZUXdMZ1lJS3dZQkJRVUhNQUdHSW1oMGRIQTZMeTl2WTNOd0xtbHRjSEpsYm5OaGIyWnBZMmxoYkM1amIyMHVZbkl3VWdZSUt3WUJCUVVITUFLR1JtaDBkSEE2THk5aFkzTmhkQzVwYlhCeVpXNXpZVzltYVdOcFlXd3VZMjl0TG1KeUwzSmxjRzl6YVhSdmNtbHZMMk5sY25ScFptbGpZV1J2Y3k5aFkzTmhkQzV3TjJNd0V3WURWUjBsQkF3d0NnWUlLd1lCQlFVSEF3SXdDUVlEVlIwVEJBSXdBREFrQmdOVkhSRUVIVEFib0JrR0JXQk1BUU1Eb0JBRURqSXlPVFU0TnpBeE1EQXdNVGN3TUI4R0ExVWRJd1FZTUJhQUZMQ0ZnYk1velhZcUtTUkxYMWhLYjJqWnJMQXFNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUNBUUE2eHRwYm5id1VQRHJDV0ZGOUNzbHlJbXNTTkRnc2FkZjFKbVlRU1U4bjhYV0NIZ3ZIazF0TDQyemtVMTdXcTYwUFU2cThjTE5MVVYwOVg1WDZFd3gvc25NMzhDNHRMNjZUNHJVMkpxT1I3VzRFdzBmNDVaTHZiYzg2YWFxL2lMaGhNME1EY1ZzMjg0MEJmUW9VVmFBNFdwemQrZFdCWkU2OEtwNXRNc0lyTEt6eTdWZEZzVkQvTHpkbEsrcVhSaFBSNTkveE1hRngxWFRuSzMvZ05qOVV0aFMxdXVoUml0SFFjNWtXSG8wbTF5MlplbnJMUnoxZjU2ZkdHMStHRU41dHprdDdYYlJJbVpTLy9DSHhLWWVMaWNIa3NWdHpUM09WSktQQ25aeTdVU3BJMC93NXhxZDFVdHk0bGpvYTFRZGRZKzkwWTFQR2hDNGIzNUhoRExqeW5xUDVYODdoVGQ3OGd1a2tqc0NIWklDZHdlZnViS0orbExmOHBoWEt4bW1zbjc3K2x5ZWVrb1RhdkVKdjZza0kyelIzL0RSUzlhMDlncW5WRW9HdE1uQ0NBUlplZ1VibXJUZFhVVC9UQllIUndHeDJnd0RwZVc5a1BkNmx3YWUvUVEyUW0rNGlnRlRvSnlsTEFETXR2anI1L2w0TE94ZTVjcFdic2xZeDBKTG15YjRUZm5vTjhtdVF2ZjE2OWM1SVZzb3N0Q3NiS2dpaTdRRER4L3g3cTRVR29JaFBCTm1LWHBsMzNFWFdaS29sdVFSanFveGlTQ0x0aGpacTJ1SFFLZ2FaQ3ZYNk5PaXU5Uk1ackFpRFEyNGdtdlZHa0d4UVZPOUN0V2Nvejg1QW9mLzRvRUhUREM3M1kwOUwxUHdqREp3MCtyQ2I2U0JSRGlDekNwREFQdz09PC9YNTA5Q2VydGlmaWNhdGU+PC9YNTA5RGF0YT48L0tleUluZm8+PC9TaWduYXR1cmU+PC9DRmU+";
        string arquivoCFeSAT = "PENGZT48aW5mQ0ZlIElkPSJDRmUzNTE4MDMyOTIyMDQxMzAwMDE2MzU5MDAwNDU2MzA2MDAwMTQ0MTUwMTUxNCIgdmVyc2FvPSIwLjA3IiB2ZXJzYW9EYWRvc0VudD0iMC4wNyIgdmVyc2FvU0I9IjAyMDAzNiI +PGlkZT48Y1VGPjM1PC9jVUY+PGNORj4xNTAxNTE8L2NORj48bW9kPjU5PC9tb2Q+PG5zZXJpZVNBVD4wMDA0NTYzMDY8L25zZXJpZVNBVD48bkNGZT4wMDAxNDQ8L25DRmU+PGRFbWk+MjAxODAzMDI8L2RFbWk+PGhFbWk+MTkwMTMyPC9oRW1pPjxjRFY+NDwvY0RWPjx0cEFtYj4xPC90cEFtYj48Q05QSj4yMzQ4NzQwMzAwMDEwMjwvQ05QSj48c2lnbkFDPnAyaGhQSnoxUVBybGVnRXJ5QXVoMTlGbzU3RlU5Q2ZTenVFV0RjZUc3QTR2b1lwUERMMXY4b1VCdkhobE5lWVlEYnRERjZlTC9wNVNHUFpTLzJDUVpTZ25ReFNsTzFkdmVRc1drOVBZWWM4bzNjZExuUlVSZURjU3pSdzMrcmpmMU9RbEpIdk15bEp2WDRXTkJVZjBhcmJqL0NzNlk4MUN5Y1dmd0NWeUkrN1h0MStPWldXbTAwV1VuN0R4Yi9mZTFCT3pBSjdOOVVaVE1VblhFb3VEUkZ2RUJzZXVsdXZCaU5EOWR4M0QzRDlyMVJrcml4cVVraE9WL09ZYnVlUVM5bVdyZ0FEZmhSc0FFY3pLbzd1ZkJ3SmpoNmVldmJKZEpSTDB1clNuYjQ3WmFydFV2MGpjTlV4NnEwMjVhNmZ0d2lEbVAyZ1YzSDJnM0FJdDlBTEhYQT09PC9zaWduQUM+PGFzc2luYXR1cmFRUkNPREU+b3dMWnUyaHJiYTlGL1VDU0o5bXFtYVdRaXl3RFZMSXZLdG9Cc2VJTDNyWGZDQlN0WE5lbDQxZDArMUNtNkRaU3ZidlR5UlEwMjRvTDNDamRIdUR3VXVNN0U2dFBVNHJWSk1OZVhoNmw1WDlpbWVtZnZyL2E3ZjZtWDNKRGE4QldiR1RoM0ppaTRVYTQ0QWlUVjdVMGhuOTZhK2xtYXJNMktuSnR2L2JVbzJweHJVY1ozWXVaK2xLMnBHMmdEOEVlZXNkUDVIYTJtamZRTE1GTkFneHliMDdkMUtHSlBUa0JFRUlRYytyd0F4SWhqRkZ5Y2lpTVhRaERXRUlFZ1NBNlZZcE1QWWpKNEZQRDFtRTlTYUROK0tzN3A2MHR2ZHZZVVdaRVM1Rmp1OXR3bWdiak5iZWlUSC9IdDd5ZEVOdjNLaU5OajVaMXZxOTRYYXRUbFFKQWZRPT08L2Fzc2luYXR1cmFRUkNPREU+PG51bWVyb0NhaXhhPjAxNTwvbnVtZXJvQ2FpeGE+PC9pZGU+PGVtaXQ+PENOUEo+MjkyMjA0MTMwMDAxNjM8L0NOUEo+PHhOb21lPkNBUiBETyBCQVJBTEhPIExBTkNIT05FVEUgRUlSRUxJPC94Tm9tZT48ZW5kZXJFbWl0Pjx4TGdyPlJVQSBERVAgTEFDRVJEQSBGUkFOQ088L3hMZ3I+PG5ybz40Nzg8L25ybz48eEJhaXJybz5QSU5IRUlST1M8L3hCYWlycm8+PHhNdW4+U0FPIFBBVUxPPC94TXVuPjxDRVA+MDU0MTgwMDE8L0NFUD48L2VuZGVyRW1pdD48SUU+MTE4ODE1ODYwMTE4PC9JRT48Y1JlZ1RyaWI+MTwvY1JlZ1RyaWI+PGluZFJhdElTU1FOPk48L2luZFJhdElTU1FOPjwvZW1pdD48ZGVzdD48eE5vbWU+RmFiaW88L3hOb21lPjwvZGVzdD48ZGV0IG5JdGVtPSIxIj48cHJvZD48Y1Byb2Q+NTQ8L2NQcm9kPjx4UHJvZD5BR1VBIEFNQTwveFByb2Q+PE5DTT4yMjAyMTAwMDwvTkNNPjxDRk9QPjU0MDU8L0NGT1A+PHVDb20+VW48L3VDb20+PHFDb20+MS4wMDAwPC9xQ29tPjx2VW5Db20+MC4wODwvdlVuQ29tPjx2UHJvZD4wLjA4PC92UHJvZD48aW5kUmVncmE+QTwvaW5kUmVncmE+PHZJdGVtPjAuMDg8L3ZJdGVtPjwvcHJvZD48aW1wb3N0bz48dkl0ZW0xMjc0MT4wLjAwPC92SXRlbTEyNzQxPjxJQ01TPjxJQ01TU04xMDI+PE9yaWc+MDwvT3JpZz48Q1NPU04+MTAyPC9DU09TTj48L0lDTVNTTjEwMj48L0lDTVM+PFBJUz48UElTU04+PENTVD40OTwvQ1NUPjwvUElTU04+PC9QSVM+PENPRklOUz48Q09GSU5TU04+PENTVD40OTwvQ1NUPjwvQ09GSU5TU04+PC9DT0ZJTlM+PC9pbXBvc3RvPjwvZGV0Pjx0b3RhbD48SUNNU1RvdD48dklDTVM+MC4wMDwvdklDTVM+PHZQcm9kPjAuMDg8L3ZQcm9kPjx2RGVzYz4wLjAwPC92RGVzYz48dlBJUz4wLjAwPC92UElTPjx2Q09GSU5TPjAuMDA8L3ZDT0ZJTlM+PHZQSVNTVD4wLjAwPC92UElTU1Q+PHZDT0ZJTlNTVD4wLjAwPC92Q09GSU5TU1Q+PHZPdXRybz4wLjAwPC92T3V0cm8+PC9JQ01TVG90Pjx2Q0ZlPjAuMDg8L3ZDRmU+PC90b3RhbD48cGd0bz48TVA+PGNNUD4wNDwvY01QPjx2TVA+MC4wODwvdk1QPjwvTVA+PHZUcm9jbz4wLjAwPC92VHJvY28+PC9wZ3RvPjxpbmZBZGljPjxvYnNGaXNjbyB4Q2FtcG89IjAzLjAzLjA0LjAzIj48eFRleHRvPkNvbnN1bHRlIG8gUVJDb2RlIGRlc3RlIGV4dHJhdG8gYXRyYXZlcyBkbyBBcHAgRGVPbGhvTmFOb3RhPC94VGV4dG8+PC9vYnNGaXNjbz48L2luZkFkaWM+PC9pbmZDRmU+PFNpZ25hdHVyZSB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+PFNpZ25lZEluZm8+PENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSI+PC9DYW5vbmljYWxpemF0aW9uTWV0aG9kPjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ij48L1NpZ25hdHVyZU1ldGhvZD48UmVmZXJlbmNlIFVSST0iI0NGZTM1MTgwMzI5MjIwNDEzMDAwMTYzNTkwMDA0NTYzMDYwMDAxNDQxNTAxNTE0Ij48VHJhbnNmb3Jtcz48VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiPjwvVHJhbnNmb3JtPjxUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSI+PC9UcmFuc2Zvcm0+PC9UcmFuc2Zvcm1zPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiPjwvRGlnZXN0TWV0aG9kPjxEaWdlc3RWYWx1ZT5NNGpkWm84YUVPblRQbm1kZWNWYXM5RlZUSnJBQ01nYlppbWIrdXVVblo0PTwvRGlnZXN0VmFsdWU+PC9SZWZlcmVuY2U+PC9TaWduZWRJbmZvPjxTaWduYXR1cmVWYWx1ZT5ibkkycTFkU0prTEdaSDRhWUUrMFhjZnBpcUJibFlUMFFpZUhzc0RoY1pqc3B6SG51RVlNcmREY3F3ZkRVR3g0QStmN2RjUkdKdm5JaUZDTUpsRlhGVlZDZDRJQlh6OW9oNjY2ZmxIMHMwSm4wQ1pGcStPN2VpYkFJMU9HeHdJYzg2aEIyeEFxN1FmaUVjaE1Hb29Ya1JNczRSaksvd3F1bUhML0lVODByaUpnc1IwM0tTLzYwK3VXOEJtbnhRVUZuLzhGL3daOFVlQmFwdnc1ZmdqSlhPSWxOVTY0VnBoTjZsOEtZNVlPRmlhM090a2lKdmRRZmFLd3NRVWdBZEVLczMrTUVlelF2aUNjd1ZMMEYwK2Z3OXQwL1NZQ3AvWHkreEpETmovdzdOZkxQeUxmSjFOZXZlTEFTd1JkRXFyM1pncndKODZCRmxvWFZhdzdZZ0ExL0E9PTwvU2lnbmF0dXJlVmFsdWU+PEtleUluZm8+PFg1MDlEYXRhPjxYNTA5Q2VydGlmaWNhdGU+TUlJR2hEQ0NCR3lnQXdJQkFnSUpBUmpWeHN3aktBN29NQTBHQ1NxR1NJYjNEUUVCQ3dVQU1GRXhOVEF6QmdOVkJBb1RMRk5sWTNKbGRHRnlhV0VnWkdFZ1JtRjZaVzVrWVNCa2J5QkZjM1JoWkc4Z1pHVWdVMkZ2SUZCaGRXeHZNUmd3RmdZRFZRUURFdzlCUXlCVFFWUWdVMFZHUVZvZ1UxQXdIaGNOTVRnd01qRTNNRE13TURNMFdoY05Nak13TWpFM01ETXdNRE0wV2pDQnZURVNNQkFHQTFVRUJSTUpNREF3TkRVMk16QTJNUXN3Q1FZRFZRUUdFd0pDVWpFU01CQUdBMVVFQ0JNSlUwRlBJRkJCVlV4UE1SRXdEd1lEVlFRS0V3aFRSVVpCV2kxVFVERVBNQTBHQTFVRUN4TUdRVU10VTBGVU1TZ3dKZ1lEVlFRTEV4OUJkWFJsYm5ScFkyRmtieUJ3YjNJZ1FWSWdVMFZHUVZvZ1UxQWdVMEZVTVRnd05nWURWUVFERXk5RFFWSWdSRThnUWtGU1FVeElUeUJNUVU1RFNFOU9SVlJGSUVWSlVrVk1TVG95T1RJeU1EUXhNekF3TURFMk16Q0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQU9BL2xRbmxyZGNqTElENVFUNGdWSHN1MUJ3ZGpCc05mMFFDT0RiQlFzYUpVb0lFM21nTXF4R0hmM3AxSDFmZlNzOEdrVVVJcUErNWppODNmZGFaejlFSXBkY0JRNFZka0dyY0Q1T0RQelVCaGowREYwc1I2bFVHa29FZ0F6MnJubUxKUmo4NGUwQ0tYU1N0RnVvK2VUNEx4eDlDY1lTUGdpT0RFNk9BZkN0NGlxUzdhNVFWZVJIQnM4bVBnaWxLTkxkK1h1TDIvZCtISWpSempILzlyRW9VcENERTFVTER0YkFuV09UNDdCeEpiWHJwMGpwV3dldENZdXJlaHdGQ09GOEs4TjFMQzMxdWE1TnFBcmkvZkM4UXFWZElXV0VFeG5TSVJPQjMzYXppQ1Rod1RHbVNqbUxEQ2tQWjRSNjliZFFKMXY5b3pnR09SaUc4N0F4WkgrTUNBd0VBQWFPQ0FmQXdnZ0hzTUE0R0ExVWREd0VCL3dRRUF3SUY0REIxQmdOVkhTQUViakJzTUdvR0NTc0dBUVFCZ2V3dEF6QmRNRnNHQ0NzR0FRVUZCd0lCRms5b2RIUndPaTh2WVdOellYUXVhVzF3Y21WdWMyRnZabWxqYVdGc0xtTnZiUzVpY2k5eVpYQnZjMmwwYjNKcGJ5OWtjR012WVdOelpXWmhlbk53TDJSd1kxOWhZM05sWm1GNmMzQXVjR1JtTUdVR0ExVWRId1JlTUZ3d1dxQllvRmFHVkdoMGRIQTZMeTloWTNOaGRDNXBiWEJ5Wlc1ellXOW1hV05wWVd3dVkyOXRMbUp5TDNKbGNHOXphWFJ2Y21sdkwyeGpjaTloWTNOaGRITmxabUY2YzNBdllXTnpZWFJ6WldaaGVuTndZM0pzTG1OeWJEQ0JsQVlJS3dZQkJRVUhBUUVFZ1ljd2dZUXdMZ1lJS3dZQkJRVUhNQUdHSW1oMGRIQTZMeTl2WTNOd0xtbHRjSEpsYm5OaGIyWnBZMmxoYkM1amIyMHVZbkl3VWdZSUt3WUJCUVVITUFLR1JtaDBkSEE2THk5aFkzTmhkQzVwYlhCeVpXNXpZVzltYVdOcFlXd3VZMjl0TG1KeUwzSmxjRzl6YVhSdmNtbHZMMk5sY25ScFptbGpZV1J2Y3k5aFkzTmhkQzV3TjJNd0V3WURWUjBsQkF3d0NnWUlLd1lCQlFVSEF3SXdDUVlEVlIwVEJBSXdBREFrQmdOVkhSRUVIVEFib0JrR0JXQk1BUU1Eb0JBRURqSTVNakl3TkRFek1EQXdNVFl6TUI4R0ExVWRJd1FZTUJhQUZMQ0ZnYk1velhZcUtTUkxYMWhLYjJqWnJMQXFNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUNBUUJyUDFqUS82Sk5aaFV6OE10aURPWkNnb1hDSTJLWExwOXE2UTRDUmpDT2QxSGJkYXFRcEt0dDJablc1Yjh1Zml4b3hWN21DYnp2S2F0VW1xUU5uVFBVY3Q0Z0Zvcm9NZDNGQ1VYcSsyYVN3VjJncGZTRmlUWHpwTk9xaEZ6SXh4amJEK1dsWkdEVUVGT3NUWlk1MnpQUENEWHFnUzU1T01ReEt5ME1SbVljY2hpREdKWVBneWVqcmovWVZIcm9QREJta0d2NGl4bjdnVW4wUmVuS2lTYW9IMjlzdG14UmJ3RkpuM1NTZWV1ejhybERyeHFQa0ZwQXpzVjhHenAxVU04ZVBQSU0rNEdLb0VWK3FYVlZYOGh4bFZRUk93V2hmZHc4UzBxeml0MEwyRE5VeW53ckd3enRVSDZjc3JyZzdxRVNsTnp1YXVZTkcyNnpiTkN3bm4vZjVFVytPVkNMek5teFkySWxxd01UL0V2WXBGdVQ4VUNwQ0pLS3BjVDFtZDhQNFdpbVZtbVc3WE9LQUg5ajFBYU50cjF4T3RqK1JLNUxhOGFRMm4xOFdmemxsVDd3R2pUODhTZWp2Nkp1OE9mdVdOSTRkRm9rOFNPS2prWjhDV0tsUDZIelNRQ3pRWjZSRzJMWmljYlpoYkxqejFkRUI0TUdyUkRvNkppU3J1WHNKZC9uT1lwWmJGcFdxZ29GeXlmZUpNTDBvcWFjaWtFdUcvU2xnMHJOcTVaVmltUCtGZnB2QzNXajM5blkyS1dhMTBJWllTTDhrSHU3K3VtcWVFWGFzYUlpRnV3b1pxWWFtL0N5Y25kVWxRWjllcG02V1JxSC9FWmxGUWQ0ZWoyWHM1RDdjSDMzdnNPVy9wWjU2V2JscjY0NWlLeGhocHU4QVB5aFNPZmRFZz09PC9YNTA5Q2VydGlmaWNhdGU+PC9YNTA5RGF0YT48L0tleUluZm8+PC9TaWduYXR1cmU+PC9DRmU+";
        bool lValidCFE = false;
        // https://stackoverflow.com/questions/751511/validating-an-xml-against-referenced-xsd-in-c-sharp
        [TestMethod, TestCategory("SAT")]
        public void SAT_XSD_Validate()
        {
            lValidCFE = true;
            var asset = new XmlDocument();

            var schemaReader = new XmlTextReader(@"..\..\..\a7D.PDV.SATComunicacao\0.07\CfeRecepcao_0007.xsd");
            var schema = XmlSchema.Read(schemaReader, ValidationCallBack);

            asset.Schemas.Add(schema);

            asset.Load(@"..\..\venda-sat.xml");
            asset.Validate(ValidationCallBack);

            Assert.IsTrue(lValidCFE, "Verifique os erros no LOG");

        }

        private void ValidationCallBack(object sender, ValidationEventArgs args)
        {
            if (args.Severity == XmlSeverityType.Warning)
                Console.WriteLine("\tWarning: Matching schema not found.  No validation occurred." + args.Message);
            else
            {
                lValidCFE = false;
                Console.WriteLine("\tValidation error: " + args.Message);
            }
        }

        [TestMethod, TestCategory("SAT")]
        public void SAT_Consulta_Status()
        {
            var cod = new Random().Next(1, 999999);
            Console.WriteLine(ComunicacaoSat.ConsultarSat(cod));
        }


        [TestMethod, TestCategory("SAT")]
        public void SAT_Enviar_Venda()
        {
            // Validador XML: http://bematechpartners.com.br/wp01/?page_id=3352
            //string venda = @"<CFe><infCFe versaoDadosEnt=""0.07""><ide><CNPJ>14200166000166</CNPJ><signAC>SGR-SAT SISTEMA DE GESTAO E RETAGUARDA DO SAT</signAC><numeroCaixa>046</numeroCaixa></ide><emit><CNPJ>14200166000166</CNPJ><IE>111111111111</IE><IM>111111</IM><indRatISSQN>N</indRatISSQN></emit><dest /><det nItem=""1""><prod><cProd>4</cProd><xProd> * Servico</xProd><NCM>99</NCM><CFOP>5102</CFOP><uCom>Un</uCom><qCom>1.0000</qCom><vUnCom>1.05</vUnCom><indRegra>A</indRegra></prod><imposto><vItem12741>0.00</vItem12741><ICMS><ICMSSN102><Orig>0</Orig><CSOSN>500</CSOSN></ICMSSN102></ICMS><PIS><PISSN><CST>49</CST></PISSN></PIS><COFINS><COFINSSN><CST>49</CST></COFINSSN></COFINS></imposto></det><det nItem=""2""><prod><cProd>5</cProd><xProd>Agua</xProd><NCM>22021000</NCM><CFOP>5405</CFOP><uCom>Un</uCom><qCom>1.0000</qCom><vUnCom>2.50</vUnCom><indRegra>A</indRegra></prod><imposto><vItem12741>0.00</vItem12741><ICMS><ICMSSN102><Orig>0</Orig><CSOSN>102</CSOSN></ICMSSN102></ICMS><PIS><PISSN><CST>49</CST></PISSN></PIS><COFINS><COFINSSN><CST>49</CST></COFINSSN></COFINS></imposto></det><det nItem=""3""><prod><cProd>7</cProd><xProd>Refeicao</xProd><NCM>21069090</NCM><CFOP>5102</CFOP><uCom>Un</uCom><qCom>1.0000</qCom><vUnCom>8.00</vUnCom><indRegra>A</indRegra></prod><imposto><vItem12741>0.00</vItem12741><ICMS><ICMSSN102><Orig>0</Orig><CSOSN>500</CSOSN></ICMSSN102></ICMS><PIS><PISSN><CST>49</CST></PISSN></PIS><COFINS><COFINSSN><CST>49</CST></COFINSSN></COFINS></imposto></det><total /><pgto><MP><cMP>03</cMP><vMP>3.30</vMP></MP><MP><cMP>01</cMP><vMP>8.25</vMP></MP></pgto></infCFe></CFe>";
            //string venda = @"<CFe><infCFe versaoDadosEnt=""0.07""><ide><CNPJ>14200166000166</CNPJ><signAC>SGR-SAT SISTEMA DE GESTAO E RETAGUARDA DO SAT</signAC><numeroCaixa>002</numeroCaixa></ide><emit><CNPJ>14200166000166</CNPJ><IE>111111111111</IE><indRatISSQN>N</indRatISSQN></emit><dest /><det nItem=""1""><prod><cProd>4</cProd><xProd> * Servico</xProd><NCM>99</NCM><CFOP>5102</CFOP><uCom>Un</uCom><qCom>1.0000</qCom><vUnCom>2.60</vUnCom><indRegra>A</indRegra></prod><imposto><vItem12741>0.00</vItem12741><ICMS><ICMSSN102><Orig>0</Orig><CSOSN>500</CSOSN></ICMSSN102></ICMS><PIS><PISSN><CST>49</CST></PISSN></PIS><COFINS><COFINSSN><CST>49</CST></COFINSSN></COFINS></imposto></det><det nItem=""2""><prod><cProd>303</cProd><xProd>Abacaxi com Hortela</xProd><NCM>21069090</NCM><CFOP>5102</CFOP><uCom>Un</uCom><qCom>1.0000</qCom><vUnCom>14.00</vUnCom><indRegra>A</indRegra></prod><imposto><vItem12741>0.00</vItem12741><ICMS><ICMSSN102><Orig>0</Orig><CSOSN>500</CSOSN></ICMSSN102></ICMS><PIS><PISSN><CST>49</CST></PISSN></PIS><COFINS><COFINSSN><CST>49</CST></COFINSSN></COFINS></imposto></det><det nItem=""3""><prod><cProd>2581</cProd><xProd>1500</xProd><NCM>22030000</NCM><CFOP>5405</CFOP><uCom>Un</uCom><qCom>1.0000</qCom><vUnCom>12.00</vUnCom><indRegra>A</indRegra></prod><imposto><vItem12741>0.00</vItem12741><ICMS><ICMSSN102><Orig>0</Orig><CSOSN>102</CSOSN></ICMSSN102></ICMS><PIS><PISSN><CST>49</CST></PISSN></PIS><COFINS><COFINSSN><CST>49</CST></COFINSSN></COFINS></imposto></det><total /><pgto><MP><cMP>01</cMP><vMP>28.60</vMP></MP></pgto></infCFe></CFe>";
            string venda = File.ReadAllText(@"..\..\venda-sat.xml");
            Console.WriteLine(venda);
            var sat = new FiscalApiClient("http://localhost:8888/");
            var cod = new Random().Next(1, 999999);
            var result = sat.Venda(venda, cod);
            Console.WriteLine(result);
        }

        [TestMethod, TestCategory("SAT")]
        public void SAT_Imprimir_Impressora()
        {
            if (!CupomSATService.ImprimirCupomVenda(arquivoCFeSAT, 1, "OneNote", out Exception ex))
                Assert.Inconclusive("Verifique a impressora");
        }

        [TestMethod, TestCategory("SAT")]
        public void SAT_Imprimir_Texto()
        {
            var cupon = SATService.CupomVendaTexto(arquivoCFeSAT, 123, "COMANDA", 60);
            Console.Write(cupon);
        }

        [TestMethod, TestCategory("SAT")]
        public void SAT_Gerar_Venda()
        {
            var pedido = BLL.Pedido.CarregarCompleto(95512);
            var cfe = CFeVenda.CarregarCFe(pedido, false);
        }
    }
}